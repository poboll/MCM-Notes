% 定义广州的经纬度
guangzhou_coords = [23.1291, 113.2644];

% 前50个城市及其经纬度信息
cities = {
    '福州', 26.0745, 119.2965;
    '汕尾', 22.7877, 115.3751;
    '安庆', 30.5086, 117.0472;
    '北京', 39.9042, 116.4074;
    '常德', 29.0316, 111.6537;
    '成都', 30.5728, 104.0668;
    '楚雄州', 25.0367, 101.5460;
    '儋州', 19.5209, 109.5820;
    '定西', 35.5807, 104.6266;
    '恩施', 30.2722, 109.4880;
    '贵阳', 26.6477, 106.6302;
    '杭州', 30.2741, 120.1551;
    '贺州', 24.4033, 111.5672;
    '呼和浩特', 40.8426, 111.7490;
    '惠州', 23.1103, 114.4168;
    '济源', 35.0671, 112.5876;
    '嘉峪关', 39.8023, 98.2901;
    '晋城', 35.4907, 112.8513;
    '可克达拉', 43.6836, 81.1640;
    '丽江', 26.8721, 100.2296;
    '临高', 19.9186, 109.6873;
    '泸州', 28.8724, 105.4479;
    '南充', 30.8375, 106.0806;
    '攀枝花', 26.5823, 101.7160;
    '潜江', 30.4268, 112.8990;
    '琼海', 19.2592, 110.4745;
    '三亚', 18.2528, 109.5119;
    '邵阳', 27.2333, 111.4672;
    '朔州', 39.3316, 112.4320;
    '台州', 28.6564, 121.4208;
    '通化', 41.7212, 125.9406;
    '潍坊', 36.7068, 119.1035;
    '五家渠', 44.1674, 87.5269;
    '咸宁', 29.8413, 114.3228;
    '雄安新区', 38.9990, 115.8540;
    '扬州', 32.3929, 119.4210;
    '中山', 22.5159, 113.3926;
    '大理', 25.6065, 100.2676;
    '包头', 40.6582, 109.8463;
    '忻州', 38.4167, 112.7196;
    '珠海', 22.2770, 113.5620;
    '凉山', 27.8268, 99.7071;
    '运城', 35.0958, 111.0036;
    '白城', 45.6160, 123.9691;
    '唐山', 39.6296, 118.1944;
    '博尔塔拉', 44.9065, 82.0721;
    '阜新', 42.0297, 121.6761;
    '宝鸡', 34.3670, 107.2313;
    '阿里', 32.3151, 81.1522;
    '保亭', 18.6011, 109.6957
};

% 转换为表格
city_df = cell2table(cities, 'VariableNames', {'城市', '纬度', '经度'});

% 计算从广州到其他城市的距离
distances = zeros(height(city_df), 1);
for i = 1:height(city_df)
    city_coords = [city_df.("纬度")(i), city_df.("经度")(i)];
    distances(i) = deg2km(distance('gc', guangzhou_coords, city_coords)); % 使用deg2km转换距离为公里
end

% 假设高铁速度为300 km/h，高铁费用为0.5元/km
high_speed = 300;  % km/h
cost_per_km = 0.5;  % 元/km

% 计算高铁时间和费用
city_df.("高铁时间") = distances / high_speed;
city_df.("高铁费用")  = distances * cost_per_km;

% 添加出发城市信息
city_df.("出发城市") = repmat({'广州'}, height(city_df), 1);

% 保存为CSV文件
writetable(city_df, 'high_speed_rail.csv');

% 绘制高铁时间的柱状图
figure;
bar(city_df.("高铁时间"));
set(gca, 'XTickLabel', city_df.("城市"), 'XTickLabelRotation', 45);
xlabel('城市');
ylabel('高铁时间（小时）');
title('广州到各城市的高铁时间');
grid on;

% 绘制高铁费用的柱状图
figure;
bar(city_df.("高铁费用"));
set(gca, 'XTickLabel', city_df.("城市"), 'XTickLabelRotation', 45);
xlabel('城市');
ylabel('高铁费用（元）');
title('广州到各城市的高铁费用');
grid on;
