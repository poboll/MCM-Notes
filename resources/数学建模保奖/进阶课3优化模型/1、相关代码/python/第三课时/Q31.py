import pandas as pd

# 读取CSV文件
file_path = 'Q3_top50_topscore.csv'
data = pd.read_csv(file_path)

# 城市经纬度数据
city_data = {
    '城市': [
        '福州', '大理', '恩施', '潜江', '咸宁', '三亚', '惠州', '朔州', '常德', '攀枝花',
        '晋城', '琼海', '可克达拉', '成都', '临高', '台州', '定西', '楚雄州', '嘉峪关', '扬州',
        '雄安新区', '济源', '北京', '儋州', '呼和浩特', '中山', '贵阳', '丽江', '安庆', '五家渠',
        '南充', '潍坊', '贺州', '邵阳', '通化', '杭州', '泸州', '汕尾', '济南', '河源', '衡阳',
        '马鞍山', '迪庆', '鄂尔多斯', '清远', '邢台', '七台河', '铁岭', '海口'
    ],
    '纬度': [
        26.0745, 25.6065, 30.2722, 30.4268, 29.8413, 18.2528, 23.1103, 39.3316, 29.0316, 26.5823,
        35.4907, 19.2592, 43.6836, 30.5728, 19.9186, 28.6564, 35.5807, 25.0367, 39.8023, 32.3929,
        38.9990, 35.0671, 39.9042, 19.5209, 40.8426, 22.5159, 26.6477, 26.8721, 30.5086, 44.1674,
        30.8375, 36.7068, 24.4033, 27.2333, 41.7212, 30.2741, 28.8724, 22.7877, 36.6512, 23.7338, 26.8930,
        31.6765, 27.8268, 39.6085, 23.6820, 37.0700, 45.7700, 42.2860, 20.0442
    ],
    '经度': [
        119.2965, 100.2676, 109.4880, 112.8990, 114.3228, 109.5119, 114.4168, 112.4320, 111.6537, 101.7160,
        112.8513, 110.4745, 81.1640, 104.0668, 109.6873, 121.4208, 104.6266, 101.5460, 98.2901, 119.4210,
        115.8540, 112.5876, 116.4074, 109.5820, 111.7490, 113.3926, 106.6302, 100.2296, 117.0472, 87.5269,
        106.0806, 119.1035, 111.5672, 111.4672, 125.9406, 120.1551, 105.4479, 115.3751, 117.1201, 114.7074,
        112.5707, 118.5065, 99.7071, 109.7813, 113.0118, 114.5040, 131.0129, 123.8443, 110.1983
    ]
}

# 将城市经纬度数据转换为DataFrame
city_df = pd.DataFrame(city_data)

# 将城市经纬度信息合并到原始数据中
merged_data = pd.merge(data, city_df, left_on='来源城市', right_on='城市', how='left')

# 删除多余的“城市”列
merged_data.drop(columns=['城市'], inplace=True)

# 保存新的CSV文件
output_file_path = 'Q3_top50_topscore_1.csv'
merged_data.to_csv(output_file_path, index=False)

print(f"已成功将经纬度信息添加到CSV文件并保存到 {output_file_path}")
